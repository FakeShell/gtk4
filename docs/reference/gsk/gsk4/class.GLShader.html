<!--
SPDX-FileCopyrightText: 2021 GNOME Foundation

SPDX-License-Identifier: Apache-2.0 OR GPL-3.0-or-later
-->

<!--
SPDX-FileCopyrightText: 2021 GNOME Foundation

SPDX-License-Identifier: Apache-2.0 OR GPL-3.0-or-later
-->

<!DOCTYPE html>
<html lang="en">
<head>
  <title>Gsk.GLShader</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta charset="utf-8" />

  
  <meta property="og:type" content="website"/>

  
  <meta property="og:image:width" content="256"/>
  <meta property="og:image:height" content="256"/>
  <meta property="og:image:secure_url" content="gtk-logo.svg"/>
  <meta property="og:image:alt" content="Gsk-4.0"/>
  

  
  <meta property="og:title" content="Gsk.GLShader"/>
  <meta property="og:description" content="Reference for Gsk.GLShader"/>
  <meta name="twitter:title" content="Gsk.GLShader"/>
  <meta name="twitter:description" content="Reference for Gsk.GLShader"/>


  
  <meta name="twitter:card" content="summary"/>

  

  <link rel="stylesheet" href="style.css" type="text/css" />

  

  
  <script src="urlmap.js"></script>
  
  
  <script src="fzy.js"></script>
  <script src="search.js"></script>
  
  <script src="main.js"></script>
  <!--[if IE]><script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
</head>

<body>
  <div id="body-wrapper" tabindex="-1">

    <nav class="sidebar devhelp-hidden">
      
      <div class="section">
        <img src="gtk-logo.svg" class="logo"/>
      </div>
      
      
      <div class="search section">
        <form id="search-form" autocomplete="off">
          <input id="search-input" type="text" name="do-not-autocomplete" placeholder="Click, or press 's' to search" autocomplete="off"/>
        </form>
      </div>
      
      <div class="section namespace">
        <h3><a href="index.html">Gsk</a></h3>
        <p>API Version: 4.0</p>
        
        <p>Library Version: 4.3.1</p>
        
      </div>
      
<div class="section">
  <h5>Type</h5>
  <div class="links">
    <a class="current" href="class.GLShader.html#description">GLShader</a>
  </div>
</div>


<div class="section">
  <h5>Constructors</h5>
  <div class="links">
  
    <a class="ctor" href="ctor.GLShader.new_from_bytes.html">new_from_bytes</a>
  
    <a class="ctor" href="ctor.GLShader.new_from_resource.html">new_from_resource</a>
  
  </div>
</div>



<div class="section">
  <h5>Instance methods</h5>
  <div class="links">
  
    <a class="method" href="method.GLShader.compile.html">compile</a>
  
    <a class="method" href="method.GLShader.find_uniform_by_name.html">find_uniform_by_name</a>
  
    <a class="method" href="method.GLShader.format_args.html">format_args</a>
  
    <a class="method" href="method.GLShader.format_args_va.html">format_args_va</a>
  
    <a class="method" href="method.GLShader.get_arg_bool.html">get_arg_bool</a>
  
    <a class="method" href="method.GLShader.get_arg_float.html">get_arg_float</a>
  
    <a class="method" href="method.GLShader.get_arg_int.html">get_arg_int</a>
  
    <a class="method" href="method.GLShader.get_arg_uint.html">get_arg_uint</a>
  
    <a class="method" href="method.GLShader.get_arg_vec2.html">get_arg_vec2</a>
  
    <a class="method" href="method.GLShader.get_arg_vec3.html">get_arg_vec3</a>
  
    <a class="method" href="method.GLShader.get_arg_vec4.html">get_arg_vec4</a>
  
    <a class="method" href="method.GLShader.get_args_size.html">get_args_size</a>
  
    <a class="method" href="method.GLShader.get_n_textures.html">get_n_textures</a>
  
    <a class="method" href="method.GLShader.get_n_uniforms.html">get_n_uniforms</a>
  
    <a class="method" href="method.GLShader.get_resource.html">get_resource</a>
  
    <a class="method" href="method.GLShader.get_source.html">get_source</a>
  
    <a class="method" href="method.GLShader.get_uniform_name.html">get_uniform_name</a>
  
    <a class="method" href="method.GLShader.get_uniform_offset.html">get_uniform_offset</a>
  
    <a class="method" href="method.GLShader.get_uniform_type.html">get_uniform_type</a>
  
  </div>
</div>



<div class="section">
  <h5>Properties</h5>
  <div class="links">
  
    <a class="property" href="property.GLShader.resource.html">resource</a>
  
    <a class="property" href="property.GLShader.source.html">source</a>
  
  </div>
</div>











    </nav>

    
    <button id="btn-to-top" class="hidden"><span class="up-arrow"></span></button>
    

    
<section id="main" class="content">
  <header>
    <h3>Class</h3>
    <h1 aria-label="Name"><a href="index.html">Gsk</a><span class="sep" role="presentation"></span>GLShader</h1>
  </header>

  <section>
    <summary>
      <div class="toggle-wrapper">
        <h4 id="description" style="display:flex;">
          Description
          <a href="#description" class="anchor"></a>
          
          <a class="srclink" title="go to source location" href="https://gitlab.gnome.org/GNOME/gtk/-/blob/master/gsk/gskglshader.c#L19">[src]</a>
          
        </h4>

        <pre><code>final class Gsk.GLShader : GObject.Object {
  /* No available fields */
}</pre></code>

        <div class="docblock">
          <p>A <code>GskGLShader</code> is a snippet of <span class="caps">GLSL</span> that is meant to run in the
fragment shader of the rendering&nbsp;pipeline.</p>
<p>A fragment shader gets the coordinates being rendered as input and
produces the pixel values for that particular pixel. Additionally,
the shader can declare a set of other input arguments, called
uniforms (as they are uniform over all the calls to your shader in
each instance of use). A shader can also receive up to 4
textures that it can use as input when producing the pixel&nbsp;data.</p>
<p><code>GskGLShader</code> is usually used with gtk_snapshot_push_gl_shader()
to produce a <a href="class.GLShaderNode.html"><code>GskGLShaderNode</code></a> in the rendering hierarchy,
and then its input textures are constructed by rendering the child
nodes to textures before rendering the shader node itself. (You can
pass texture nodes as children if you want to directly use a texture
as&nbsp;input).</p>
<p>The actual shader code is <span class="caps">GLSL</span> code that gets combined with
some other code into the fragment shader. Since the exact
capabilities of the <span class="caps">GPU</span> driver differs between different OpenGL
drivers and hardware, <span class="caps">GTK</span> adds some defines that you can use
to ensure your <span class="caps">GLSL</span> code runs on as many drivers as it&nbsp;can.</p>
<p>If the OpenGL driver is <span class="caps">GLES</span>, then the shader language version
is set to 100, and GSK_GLES will be defined in the&nbsp;shader.</p>
<p>Otherwise, if the OpenGL driver does not support the 3.2 core profile,
then the shader will run with language version 110 for <span class="caps">GL2</span> and 130 for <span class="caps">GL3</span>,
and GSK_LEGACY will be defined in the&nbsp;shader.</p>
<p>If the OpenGL driver supports the 3.2 code profile, it will be used,
the shader language version is set to 150, and GSK_GL3 will be defined
in the&nbsp;shader.</p>
<p>The main function the shader must implement&nbsp;is:</p>
<div class="codehilite"><pre><span></span><code> <span class="kt">void</span> <span class="n">mainImage</span><span class="p">(</span><span class="k">out</span> <span class="kt">vec4</span> <span class="n">fragColor</span><span class="p">,</span>
                <span class="k">in</span> <span class="kt">vec2</span> <span class="n">fragCoord</span><span class="p">,</span>
                <span class="k">in</span> <span class="kt">vec2</span> <span class="n">resolution</span><span class="p">,</span>
                <span class="k">in</span> <span class="kt">vec2</span> <span class="n">uv</span><span class="p">)</span>
</code></pre></div>

<p>Where the input <code>fragCoord</code> is the coordinate of the pixel we&#8217;re
currently rendering, relative to the boundary rectangle that was
specified in the <code>GskGLShaderNode</code>, and <code>resolution</code> is the width and
height of that rectangle. This is in the typical <span class="caps">GTK</span> coordinate
system with the origin in the top left. <code>uv</code> contains the u and v
coordinates that can be used to index a texture at the
corresponding point. These coordinates are in the [0..1]x[0..1]
region, with 0, 0 being in the lower left corder (which is typical
for&nbsp;OpenGL).</p>
<p>The output <code>fragColor</code> should be a <span class="caps">RGBA</span> color (with
premultiplied alpha) that will be used as the output for the
specified pixel location. Note that this output will be
automatically clipped to the clip region of the glshader&nbsp;node.</p>
<p>In addition to the function arguments the shader can define
up to 4 uniforms for textures which must be called u_textureN
(i.e. u_texture1 to u_texture4) as well as any custom uniforms
you want of types int, uint, bool, float, vec2, vec3 or&nbsp;vec4.</p>
<p>All textures sources contain premultiplied alpha colors, but if some
there are outer sources of colors there is a gsk_premultiply() helper
to compute premultiplication when&nbsp;needed.</p>
<p>Note that <span class="caps">GTK</span> parses the uniform declarations, so each uniform has to
be on a line by itself with no other code, like&nbsp;so:</p>
<div class="codehilite"><pre><span></span><code><span class="k">uniform</span> <span class="kt">float</span> <span class="n">u_time</span><span class="p">;</span>
<span class="k">uniform</span> <span class="kt">vec3</span> <span class="n">u_color</span><span class="p">;</span>
<span class="k">uniform</span> <span class="kt">sampler2D</span> <span class="n">u_texture1</span><span class="p">;</span>
<span class="k">uniform</span> <span class="kt">sampler2D</span> <span class="n">u_texture2</span><span class="p">;</span>
</code></pre></div>

<p><span class="caps">GTK</span> uses the the &#8220;gsk&#8221; namespace in the symbols it uses in the
shader, so your code should not use any symbols with the prefix gsk
or <span class="caps">GSK</span>. There are some helper functions declared that you can&nbsp;use:</p>
<div class="codehilite"><pre><span></span><code><span class="kt">vec4</span> <span class="n">GskTexture</span><span class="p">(</span><span class="kt">sampler2D</span> <span class="n">sampler</span><span class="p">,</span> <span class="kt">vec2</span> <span class="n">texCoords</span><span class="p">);</span>
</code></pre></div>

<p>This samples a texture (e.g. u_texture1) at the specified
coordinates, and containes some helper ifdefs to ensure that
it works on all OpenGL&nbsp;versions.</p>
<p>You can compile the shader yourself using <a href="method.GLShader.compile.html">gsk_gl_shader_compile()</a>,
otherwise the <span class="caps">GSK</span> renderer will do it when it handling the glshader
node. If errors occurs, the returned <code>error</code> will include the glsl
sources, so you can see what <span class="caps">GSK</span> was passing to the compiler. You
can also set GSK_DEBUG=shaders in the environment to see the sources
and other relevant information about all shaders that <span class="caps">GSK</span> is&nbsp;handling.</p>
<h1 id="an-example-shader">An example shader<a class="md-anchor" href="#an-example-shader" title="Permanent link"></a></h1>
<p><span class="dquo">&#8220;</span>`glsl
uniform float position;
uniform sampler2D u_texture1;
uniform sampler2D&nbsp;u_texture2;</p>
<p>void mainImage(out vec4 fragColor,
               in vec2 fragCoord,
               in vec2 resolution,
               in vec2 uv) {
  vec4 source1 = GskTexture(u_texture1, uv);
  vec4 source2 = GskTexture(u_texture2,&nbsp;uv);</p>
<p>fragColor = position * source1 + (1.0 - position) * source2;
}&nbsp;&#8220;`.</p>
        </div>

        <div class="docblock">
          <table class="attributes">
            
            
            
          </table>
        </div>

        
      </div>
    </summary>

    
    <div class="toggle-wrapper hierarchy">
      <h4 id="hierarchy">
        Hierarchy
        <a href="#hierarchy" class="anchor"></a>
      </h4>
      <div class="docblock" alt="Hierarchy for Gsk.GLShader">
        <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.44.0 (0)
 -->
<!-- Title: hierarchy Pages: 1 -->
<svg width="118pt" height="116pt"
 viewBox="0.00 0.00 118.00 116.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 112)">
<title>hierarchy</title>
<!-- this -->
<g id="node1" class="node">
<title>this</title>
<g id="a_node1"><a xlink:title="GskGLShader">
<path fill="none" stroke="black" d="M98,-36C98,-36 12,-36 12,-36 6,-36 0,-30 0,-24 0,-24 0,-12 0,-12 0,-6 6,0 12,0 12,0 98,0 98,0 104,0 110,-6 110,-12 110,-12 110,-24 110,-24 110,-30 104,-36 98,-36"/>
<text text-anchor="middle" x="55" y="-14.3" font-family="Times-Roman" font-size="14.00">GskGLShader</text>
</a>
</g>
</g>
<!-- ancestor_0 -->
<g id="node2" class="node">
<title>ancestor_0</title>
<g id="a_node2"><a xlink:title="GObject.Object">
<path fill="none" stroke="black" d="M79,-108C79,-108 31,-108 31,-108 25,-108 19,-102 19,-96 19,-96 19,-84 19,-84 19,-78 25,-72 31,-72 31,-72 79,-72 79,-72 85,-72 91,-78 91,-84 91,-84 91,-96 91,-96 91,-102 85,-108 79,-108"/>
<text text-anchor="middle" x="55" y="-86.3" font-family="Times-Roman" font-size="14.00">GObject</text>
</a>
</g>
</g>
<!-- ancestor_0&#45;&#45;this -->
<g id="edge1" class="edge">
<title>ancestor_0&#45;&#45;this</title>
<path fill="none" stroke="black" d="M55,-71.7C55,-60.85 55,-46.92 55,-36.1"/>
</g>
</g>
</svg>

      </div>
    </div>
    

    
    <div class="toggle-wrapper ancestors">
      <h4 id="ancestors">
        Ancestors
        <a href="#ancestors" class="anchor"></a>
      </h4>

      <div class="docblock">
        <ul>
        
          
          <li class="class">GObject</a></li>
          
        
        </ul>
      </div>
    </div>
    

    

    
    <div class="toggle-wrapper constructors">
      <h4 id="constructors">
        Constructors
        <a href="#constructors" class="anchor"></a>
      </h4>

      <div class="docblock">
      
        <div class="">
          <h6><a href="ctor.GLShader.new_from_bytes.html">gsk_gl_shader_new_from_bytes</a></h6>

          <div class="docblock">
            <p>Creates a <code>GskGLShader</code> that will render pixels using the specified&nbsp;code.</p>
          </div>

          
        </div>
      
        <div class="">
          <h6><a href="ctor.GLShader.new_from_resource.html">gsk_gl_shader_new_from_resource</a></h6>

          <div class="docblock">
            <p>Creates a <code>GskGLShader</code> that will render pixels using the specified&nbsp;code.</p>
          </div>

          
        </div>
      
      </div>
    </div>
    

    
    <div class="toggle-wrapper methods">
      <h4 id="methods">
        Instance methods
        <a href="#methods" class="anchor"></a>
      </h4>

      <div class="docblock">
      
        <div class="">
          <h6><a href="method.GLShader.compile.html">gsk_gl_shader_compile</a></h6>
          <div class="docblock">
            <p>Tries to compile the <code>shader</code> for the given <code>renderer</code>.</p>
          </div>
          
        </div>
      
        <div class="">
          <h6><a href="method.GLShader.find_uniform_by_name.html">gsk_gl_shader_find_uniform_by_name</a></h6>
          <div class="docblock">
            <p>Looks for a uniform by the name <code>name</code>, and returns the index
of the uniform, or -1 if it was not&nbsp;found.</p>
          </div>
          
        </div>
      
        <div class="">
          <h6><a href="method.GLShader.format_args.html">gsk_gl_shader_format_args</a></h6>
          <div class="docblock">
            <p>Formats the uniform data as needed for feeding the named uniforms
values into the&nbsp;shader.</p>
          </div>
          
        </div>
      
        <div class="">
          <h6><a href="method.GLShader.format_args_va.html">gsk_gl_shader_format_args_va</a></h6>
          <div class="docblock">
            <p>Formats the uniform data as needed for feeding the named uniforms
values into the&nbsp;shader.</p>
          </div>
          
        </div>
      
        <div class="">
          <h6><a href="method.GLShader.get_arg_bool.html">gsk_gl_shader_get_arg_bool</a></h6>
          <div class="docblock">
            <p>Gets the value of the uniform <code>idx</code> in the <code>args</code> block.</p>
          </div>
          
        </div>
      
        <div class="">
          <h6><a href="method.GLShader.get_arg_float.html">gsk_gl_shader_get_arg_float</a></h6>
          <div class="docblock">
            <p>Gets the value of the uniform <code>idx</code> in the <code>args</code> block.</p>
          </div>
          
        </div>
      
        <div class="">
          <h6><a href="method.GLShader.get_arg_int.html">gsk_gl_shader_get_arg_int</a></h6>
          <div class="docblock">
            <p>Gets the value of the uniform <code>idx</code> in the <code>args</code> block.</p>
          </div>
          
        </div>
      
        <div class="">
          <h6><a href="method.GLShader.get_arg_uint.html">gsk_gl_shader_get_arg_uint</a></h6>
          <div class="docblock">
            <p>Gets the value of the uniform <code>idx</code> in the <code>args</code> block.</p>
          </div>
          
        </div>
      
        <div class="">
          <h6><a href="method.GLShader.get_arg_vec2.html">gsk_gl_shader_get_arg_vec2</a></h6>
          <div class="docblock">
            <p>Gets the value of the uniform <code>idx</code> in the <code>args</code> block.</p>
          </div>
          
        </div>
      
        <div class="">
          <h6><a href="method.GLShader.get_arg_vec3.html">gsk_gl_shader_get_arg_vec3</a></h6>
          <div class="docblock">
            <p>Gets the value of the uniform <code>idx</code> in the <code>args</code> block.</p>
          </div>
          
        </div>
      
        <div class="">
          <h6><a href="method.GLShader.get_arg_vec4.html">gsk_gl_shader_get_arg_vec4</a></h6>
          <div class="docblock">
            <p>Gets the value of the uniform <code>idx</code> in the <code>args</code> block.</p>
          </div>
          
        </div>
      
        <div class="">
          <h6><a href="method.GLShader.get_args_size.html">gsk_gl_shader_get_args_size</a></h6>
          <div class="docblock">
            <p>Get the size of the data block used to specify arguments for this&nbsp;shader.</p>
          </div>
          
        </div>
      
        <div class="">
          <h6><a href="method.GLShader.get_n_textures.html">gsk_gl_shader_get_n_textures</a></h6>
          <div class="docblock">
            <p>Returns the number of textures that the shader&nbsp;requires.</p>
          </div>
          
        </div>
      
        <div class="">
          <h6><a href="method.GLShader.get_n_uniforms.html">gsk_gl_shader_get_n_uniforms</a></h6>
          <div class="docblock">
            <p>Get the number of declared uniforms for this&nbsp;shader.</p>
          </div>
          
        </div>
      
        <div class="">
          <h6><a href="method.GLShader.get_resource.html">gsk_gl_shader_get_resource</a></h6>
          <div class="docblock">
            <p>Gets the resource path for the <span class="caps">GLSL</span> sourcecode being used
to render this&nbsp;shader.</p>
          </div>
          
        </div>
      
        <div class="">
          <h6><a href="method.GLShader.get_source.html">gsk_gl_shader_get_source</a></h6>
          <div class="docblock">
            <p>Gets the <span class="caps">GLSL</span> sourcecode being used to render this&nbsp;shader.</p>
          </div>
          
        </div>
      
        <div class="">
          <h6><a href="method.GLShader.get_uniform_name.html">gsk_gl_shader_get_uniform_name</a></h6>
          <div class="docblock">
            <p>Get the name of the declared uniform for this shader at index <code>idx</code>.</p>
          </div>
          
        </div>
      
        <div class="">
          <h6><a href="method.GLShader.get_uniform_offset.html">gsk_gl_shader_get_uniform_offset</a></h6>
          <div class="docblock">
            <p>Get the offset into the data block where data for this uniforms is&nbsp;stored.</p>
          </div>
          
        </div>
      
        <div class="">
          <h6><a href="method.GLShader.get_uniform_type.html">gsk_gl_shader_get_uniform_type</a></h6>
          <div class="docblock">
            <p>Get the type of the declared uniform for this shader at index <code>idx</code>.</p>
          </div>
          
        </div>
      
      </div>

      
        
      

      
    </div>
    

    
    <div class="toggle-wrapper properties">
      <h4 id="properties">
        Properties
        <a href="#properties" class="anchor"></a>
      </h4>

      <div class="docblock">
      
        <div class="">
          <h6><a href="property.GLShader.resource.html">Gsk.GLShader:resource</a></h6>

          <div class="docblock">
            <p>Resource containing the source code for the&nbsp;shader.</p>
          </div>

          
        </div>
      
        <div class="">
          <h6><a href="property.GLShader.source.html">Gsk.GLShader:source</a></h6>

          <div class="docblock">
            No description available.
          </div>

          
        </div>
      
      </div>

      
        
      

      

    </div>
    

    

    
    <div class="class toggle-wrapper default-hide">
      <h4 id="class-struct">
        Class structure
        <a href="#class-struct" class="anchor"></a>
      </h4>

      <div class="docblock">
        <pre><code>struct GskGLShaderClass {
  GObjectClass parent_class;
  
}</code></pre>
      </div>

      
      <div class="docblock">
        <h6>Class members</h6>

        <table class="members">
        
        <tr>
          <td style="vertical-align:top"><code>parent_class</code></td>
          <td style="vertical-align:top"><pre><code>GObjectClass</code></pre></td>
        </tr>
        <tr>
          <td>&nbsp;</td>
          <td style="vertical-align:top">No description available.</td>
        </td>
        
        </table>
      </div>
      
    </div>
    

    

     

    

  </section>
</section>


    <section id="search" class="content hidden"></section>

    <footer>
    
    </footer>
  </div>
</body>
</html>