From: Simon McVittie <smcv@debian.org>
Date: Thu, 2 Sep 2021 23:31:54 +0100
Subject: Skip some known-failing tests on mips-family architectures

Forwarded: no
---
 testsuite/gsk/meson.build      | 10 ++++++++--
 testsuite/reftests/meson.build | 19 +++++++++++++------
 2 files changed, 21 insertions(+), 8 deletions(-)

diff --git a/testsuite/gsk/meson.build b/testsuite/gsk/meson.build
index 106661a..06e1d18 100644
--- a/testsuite/gsk/meson.build
+++ b/testsuite/gsk/meson.build
@@ -77,15 +77,21 @@ compare_render_tests = [
   'scale-up-down',
   'shadow-in-opacity',
   'texture-url',
-  'repeat',
   'repeat-no-repeat',
-  'repeat-negative-coords',
   'repeat-texture',
   'transform-in-transform',
   'transform-in-transform-in-transform',
   'rounded-clip-in-clip-3d', # not really 3d, but cairo fails it
 ]
 
+if not host_machine.cpu_family().contains('mips')
+  # https://gitlab.gnome.org/GNOME/gtk/-/issues/4228
+  compare_render_tests += [
+    'repeat',
+    'repeat-negative-coords',
+  ]
+endif
+
 # these are too sensitive to differences in the renderers
 # to run in ci, but still useful to keep around
 informative_render_tests = [
diff --git a/testsuite/reftests/meson.build b/testsuite/reftests/meson.build
index 0b6d0fa..b7d2fcf 100644
--- a/testsuite/reftests/meson.build
+++ b/testsuite/reftests/meson.build
@@ -71,9 +71,6 @@ testdata = [
   'background-area.css',
   'background-area.ref.ui',
   'background-area.ui',
-  'background-blend-mode-clip-interaction.css',
-  'background-blend-mode-clip-interaction.ref.ui',
-  'background-blend-mode-clip-interaction.ui',
   'background-color-transparent.css',
   'background-color-transparent.ref.ui',
   'background-color-transparent.ui',
@@ -92,9 +89,6 @@ testdata = [
   'background-position-repeat.ref.ui',
   'background-position-repeat.ui',
   'background-position-repeat-bg.png',
-  'background-position-simple.css',
-  'background-position-simple.ref.ui',
-  'background-position-simple.ui',
   'background-repeat-clip.css',
   'background-repeat-clip.ref.ui',
   'background-repeat-clip.ui',
@@ -581,6 +575,19 @@ xfails = [
   'border-half-pixel.ui'
 ]
 
+if not host_machine.cpu_family().contains('mips')
+  testdata += [
+    # https://gitlab.gnome.org/GNOME/gtk/-/issues/4618
+    'background-blend-mode-clip-interaction.css',
+    'background-blend-mode-clip-interaction.ref.ui',
+    'background-blend-mode-clip-interaction.ui',
+    # https://gitlab.gnome.org/GNOME/gtk/-/issues/4228
+    'background-position-simple.css',
+    'background-position-simple.ref.ui',
+    'background-position-simple.ui',
+  ]
+endif
+
 reftest_env = environment()
 reftest_env.set('GTK_A11Y', 'test')
 reftest_env.set('G_TEST_SRCDIR', meson.current_source_dir())
